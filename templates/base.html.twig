<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Cache-control" content="private">
	<title>AYSO Section 1: {% block title %}Referee Scheduler{% endblock %}</title>

	<link rel="icon" href="/images/favicon.ico" sizes="16x16">
	<link href='{{ base_url() }}/css/bootstrap.min.css' rel='stylesheet' type='text/css'/>
	<link href='{{ base_url() }}/css/app.css' rel='stylesheet' type='text/css'/>
	
	{% block head %}{% endblock %}

</head>

<body>
	{% block layout %}{% endblock %}
<br>
<!-- footer -->
    <div class="footer clear-fix">
        <hr>
	<div class="center">
	    <p>Questions?  Contact the <a href="mailto:jodykinsey23@gmail.com">Section 1 Referee Assignor.</a></p>
        {% if ( view.rep == 'Section 1' ) %}
    		<p>Find an issue with the Scheduler?  Log it in the <a href="https://github.com/rrone/refsched/issues" target="_blank">issue tracker</a><a href='{{ base_url() }}/adm'>.</a></p>
        {% else %}
            <p>Find an issue with the Scheduler?  Log it in the <a href="https://github.com/rrone/refsched/issues" target="_blank">issue tracker.</a></p>
        {% endif %}
	</div>
	{#<!--<a href="/">Home</a> - <a href="#">Contact Us</a><br>-->#}
                {#</a>Corrections or additions to this web page can be sent to: <a href="mailto:web.ayso@gmail.com">web.ayso@gmail.com</a><br>#}
                {#&copy;2016  <a href="http://aysosection1.org">Section 1</a>, American Youth Soccer Organization <br/>#}
	{#AYSO logos and graphics copyright by the <a href="http://www.ayso.org" class="flinks">American Youth Soccer Organization</a> and used with permission.#}
	{#</span></p>#}
    </div>

</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.serializeJSON/2.7.2/jquery.serializejson.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>

<script type="text/javascript">
	 var _gaq = _gaq || [];
	 _gaq.push(['_setAccount', 'UA-XXXXXXXX-X']);
	 _gaq.push(['_trackPageview']);

	 (function() {
		  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	 })();

	 function api_call(url,method,data,onready)
	 {
         if (typeof(url) == 'undefined')  url = "/";
         if (typeof(method) == 'undefined')  method = "GET";
		 if (typeof(data) == 'undefined')    data = {};

		 $.ajax({
			 url: url,
			 data: data,
			 type: method,
			 dataType: 'jsonp',
			 beforeSend : function(xhr) {
				 var cookie = 'Area 1B';
				 console.info( "adding sessionKey: "+ cookie );
				 xhr.setRequestHeader('sessionKey', cookie);
			 },
		 }).done(function( response ) {
			 // done
			 response = { isSuccess: (response.status == "OK"), connectionFailure: false, authorisationFailure: (response.status == "NOT_AUTHORIZED"), data: response.data};
			 if ((typeof(onready) != 'undefined') && (onready != null)) onready( response );
		 }).fail(function( status ) {
			 // failed
			 response = { isSuccess: false, connectionFailure: true,authorisationFailure: false, data: status};
			 if ((typeof(onready) != 'undefined') && (onready != null)) onready( response );
		 });
	 };

     $(document).ready( function() {
         fetchSimilarHeaders()
     });

     function fetchSimilarHeaders () {
         var request = new XMLHttpRequest();
         request.onreadystatechange = function () {
             if (request.readyState === 4) {
                 //
                 // The following headers may often be similar
                 // to those of the original page request...
                 //
                 headers = request.getResponseHeader('sessionKey');
                 storeHeaders(headers);
             }
         };

         //
         // Re-request the same page (document.location)
         // We hope to get the same or similar response headers to those which
         // came with the current page, but we have no guarantee.
         // Since we are only after the headers, a HEAD request may be sufficient.
         //
         request.open('HEAD', document.location, true);
         request.send(null);
     }

     function storeHeaders(data) {
         if (typeof data !== 'undefined') {
             sessionStorage.setItem('sessionKey', data);
             $.cookie('sessionKey', data);
         }
     }

     $("a").on("click", function() {
         var linkAddress = $(this).attr('href');
         var key = sessionStorage.getItem('sessionKey');

//         $.ajaxSetup({
//         });
//
//         if(linkAddress.indexOf('?') == -1 ) {
//             var newurl = linkAddress + "?info=" + key;
//         } else {
//             var newurl = linkAddress + "&info=" + key;
//         }
//
//         console.info (newurl);

         // Sends your custom header
//         window.location.href = newurl;
     });

     {% block script %}{% endblock %}
</script>
</html>
